{% extends 'base.html' %}
{% block title %}Event Details{% endblock %}

{% block content %}
<div class="container">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0"><i class="bi bi-calendar2-event me-2"></i>{{ event.title }}</h2>
    <a href="{% url 'tracking:events_calendar' %}" class="btn btn-outline-secondary">
      <i class="bi bi-arrow-left me-1"></i>Back to Calendar
    </a>
  </div>

  <div class="row g-3">
    <div class="col-lg-5">
      <div class="card">
        <div class="card-header">Event Info</div>
        <div class="card-body">
          <p class="mb-1"><strong>Type:</strong> {{ event.get_event_type_display }}</p>
          <p class="mb-1"><strong>Team:</strong> {{ event.team.name }}</p>
          <p class="mb-1"><strong>When:</strong> {{ event.start_datetime }} – {{ event.end_datetime }}</p>
          {% if event.location %}<p class="mb-1"><strong>Location:</strong> {{ event.location }}</p>{% endif %}
          {% if event.description %}<p class="mb-0"><strong>Notes:</strong> {{ event.description }}</p>{% endif %}
        </div>
      </div>
    </div>
    <div class="col-lg-7">
      <div class="card">
        <div class="card-header">Players expected to miss this event</div>
        <div class="card-body">
          {% if missing_injuries %}
            <div class="table-responsive">
              <table class="table table-sm align-middle">
                <thead>
                  <tr>
                    <th>Player</th>
                    <th>Injury</th>
                    <th>Severity</th>
                    <th>Status</th>
                    <th>Injury Date</th>
                    <th>Expected RTP</th>
                  </tr>
                </thead>
                <tbody>
                  {% for inj in missing_injuries %}
                    <tr>
                      <td>{{ inj.player.get_full_name|default:inj.player.username }}</td>
                      <td>{{ inj.injury_type.name }} ({{ inj.body_part.name }})</td>
                      <td><span class="badge" style="background-color: {{ inj.severity.color_code }}">{{ inj.severity.name }}</span></td>
                      <td>{{ inj.status }}</td>
                      <td>{{ inj.injury_date }}</td>
                      <td>{{ inj.return_to_play_date|default:'—' }}</td>
                    </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
          {% else %}
            <div class="alert alert-success mb-0">
              <i class="bi bi-check-circle me-1"></i>No expected absences for this event.
            </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}


